<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fibonacci Sequence & Curve Visualizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .glass-panel { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); border: 1px solid rgba(226, 232, 240, 0.8); }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        canvas { image-rendering: antialiased; width: 100%; height: 100%; }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8 flex flex-col">

    <div class="max-w-6xl mx-auto flex-grow w-full">
        <header class="mb-8 text-center">
            <h2 class="text-4xl font-bold text-slate-800 mb-2">Akole Taluka Maths and Science Exhibition 2025</h2>
            <h2 class="text-4xl font-bold text-slate-800 mb-2">Karmaveer Bhaurao Patil Prathamik and Madhyamik Ashramshala, Pimpaldari</h2>
            <h1 class="text-4xl font-bold text-slate-800 mb-2">Fibonacci Visualizer</h1>
            <p class="text-slate-600">Proportional Golden Spiral generated from the sequence: 1, 1, 2, 3, 5, 8...</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-1 space-y-6">
                <!-- Control Panel -->
                <div class="glass-panel p-6 rounded-2xl shadow-sm">
                    <label class="block text-sm font-semibold text-slate-700 mb-2">Number of Terms (n)</label>
                    <div class="flex gap-2">
                        <input type="number" id="fibInput" value="10" min="2" max="20" 
                               class="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all">
                        <button onclick="generate()" 
                                class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-semibold transition-colors shadow-md active:scale-95">
                            Generate
                        </button>
                    </div>
                </div>

                <!-- Sequence Table -->
                <div class="glass-panel rounded-2xl shadow-sm overflow-hidden flex flex-col h-[350px]">
                    <div class="p-4 border-b border-slate-100 flex justify-between items-center bg-white/50">
                        <h2 class="font-bold text-slate-700">Sequence Table</h2>
                        <button onclick="downloadCSV()" class="text-xs text-indigo-600 hover:underline font-medium">Export CSV</button>
                    </div>
                    <div class="overflow-y-auto custom-scrollbar flex-grow" id="tableWrapper">
                        <table class="w-full text-left border-collapse">
                            <thead class="sticky top-0 bg-slate-50">
                                <tr>
                                    <th class="p-4 text-xs font-bold text-slate-500 uppercase tracking-wider border-b">Index</th>
                                    <th class="p-4 text-xs font-bold text-slate-500 uppercase tracking-wider border-b">Value</th>
                                </tr>
                            </thead>
                            <tbody id="fibTableBody" class="text-slate-700"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Legal & Licensing Panel -->
                <div class="glass-panel p-5 rounded-2xl shadow-sm space-y-4">
                    <h3 class="text-xs font-bold text-slate-500 uppercase tracking-widest border-b border-slate-100 pb-2">Licensing & Terms</h3>
                    
                    <div>
                        <h4 class="text-[11px] font-bold text-slate-700 mb-1">MIT License (Software)</h4>
                        <p class="text-[11px] text-slate-500 leading-relaxed">
                            The underlying code is open-source. You may modify and redistribute it, provided the original copyright is included.
                        </p>
                    </div>

                    <div>
                        <h4 class="text-[11px] font-bold text-slate-700 mb-1">Creative Commons (Content)</h4>
                        <p class="text-[11px] text-slate-500 leading-relaxed">
                            Visual designs and educational data are licensed under <strong>CC BY 4.0</strong>. Attribution is required for derivatives.
                        </p>
                    </div>

                    <div class="pt-2">
                        <a href="https://opensource.org/licenses/MIT" target="_blank" class="text-[10px] text-indigo-500 hover:underline mr-3 font-medium">Full MIT Text</a>
                        <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" class="text-[10px] text-indigo-500 hover:underline font-medium">CC BY 4.0 Details</a>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-2">
                <div class="glass-panel p-4 rounded-2xl shadow-sm h-full flex flex-col min-h-[500px]">
                    <div class="flex items-center justify-between mb-4 px-2">
                        <h2 class="font-bold text-slate-700 text-lg">Visual Canvas</h2>
                        <span id="scaleDisplay" class="text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded tracking-tight"></span>
                    </div>
                    <div class="relative flex-grow bg-white rounded-xl border border-slate-100 overflow-hidden" id="canvasContainer">
                        <canvas id="fibCanvas"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="mt-12 py-6 border-t border-slate-200 text-center">
        <p class="text-sm text-slate-400">
            &copy; 2024 • Fibonacci Visualizer for Education • Licensed under MIT & CC BY 4.0
        </p>
        <p class="text-sm text-slate-400">
            Created by Mangesh Nikam - Contact me at nik.mangesh@gmail.com
        </p>
    </footer>

    <script>
        let currentSequence = [];

        window.onload = () => {
            generate();
            window.addEventListener('resize', () => { if (currentSequence.length) drawSpiral(); });
        };

        function generate() {
            let n = parseInt(document.getElementById('fibInput').value);
            if (isNaN(n) || n < 2) n = 2;

            const sequence = [1, 1];
            for (let i = 2; i < n; i++) sequence.push(sequence[i - 1] + sequence[i - 2]);
            currentSequence = sequence;
            renderTable();
            drawSpiral();
        }

        function renderTable() {
            document.getElementById('fibTableBody').innerHTML = currentSequence.map((val, i) => `
                <tr class="hover:bg-indigo-50/50 border-b border-slate-50">
                    <td class="p-4 text-sm font-medium text-slate-400">#${i + 1}</td>
                    <td class="p-4 text-sm font-mono font-bold text-indigo-600">${val.toLocaleString()}</td>
                </tr>
            `).join('');
        }

        function getSpiralLayout(seq) {
            const layout = [];
            let rect = { left: 0, top: 0, right: 1, bottom: 1 };
            
            layout.push({ x: 0, y: 0, size: 1, dir: 0 });

            for (let i = 1; i < seq.length; i++) {
                const size = seq[i];
                let x, y;
                const dir = i % 4;

                switch (dir) {
                    case 1: // BOTTOM
                        x = rect.left;
                        y = rect.bottom;
                        rect.bottom += size;
                        break;
                    case 2: // LEFT
                        x = rect.left - size;
                        y = rect.top;
                        rect.left -= size;
                        break;
                    case 3: // TOP
                        x = rect.left;
                        y = rect.top - size;
                        rect.top -= size;
                        break;
                    case 0: // RIGHT
                        x = rect.right;
                        y = rect.top;
                        rect.right += size;
                        break;
                }
                layout.push({ x, y, size, dir });
            }
            return { layout, rect };
        }

        function drawSpiral() {
            const canvas = document.getElementById('fibCanvas');
            const ctx = canvas.getContext('2d');
            const container = document.getElementById('canvasContainer');
            
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if (currentSequence.length === 0) return;

            const { layout, rect } = getSpiralLayout(currentSequence);

            const spiralW = rect.right - rect.left;
            const spiralH = rect.bottom - rect.top;
            const padding = 60;
            const scale = Math.min((canvas.width - padding) / spiralW, (canvas.height - padding) / spiralH);
            
            document.getElementById('scaleDisplay').innerText = `Proportional Scale: ${scale.toFixed(4)}x`;

            ctx.save();
            ctx.translate(
                canvas.width / 2 - ((rect.left + rect.right) / 2) * scale,
                canvas.height / 2 - ((rect.top + rect.bottom) / 2) * scale
            );
            ctx.scale(scale, scale);

            layout.forEach((item, i) => {
                const { x, y, size, dir } = item;
                
                ctx.strokeStyle = '#cbd5e1';
                ctx.lineWidth = 1 / scale;
                ctx.strokeRect(x, y, size, size);

                ctx.beginPath();
                ctx.strokeStyle = '#4f46e5';
                ctx.lineWidth = 3 / scale;
                ctx.lineCap = 'round';

                let arcCX, arcCY, startAng, endAng;
                
                switch(dir) {
                    case 0: // Square on Right.
                        arcCX = x; arcCY = y + size;
                        startAng = 0; endAng = 1.5 * Math.PI;
                        break;
                    case 1: // Square on Bottom.
                        arcCX = x; arcCY = y;
                        startAng = 0.5 * Math.PI; endAng = 0;
                        break;
                    case 2: // Square on Left.
                        arcCX = x + size; arcCY = y;
                        startAng = Math.PI; endAng = 0.5 * Math.PI;
                        break;
                    case 3: // Square on Top.
                        arcCX = x + size; arcCY = y + size;
                        startAng = 1.5 * Math.PI; endAng = Math.PI;
                        break;
                }

                ctx.arc(arcCX, arcCY, size, startAng, endAng, true);
                ctx.stroke();
            });

            ctx.restore();
        }

        function downloadCSV() {
            const csv = "Index,Value\n" + currentSequence.map((v, i) => `${i+1},${v}`).join("\n");
            const link = document.createElement("a");
            link.href = 'data:text/csv;charset=utf-8,' + encodeURI(csv);
            link.download = 'fibonacci_inverted.csv';
            link.click();
        }
    </script>
</body>

</html>
